<!-- Mobile Navigation Menu -->
<div x-show="isMobileMenuOpen" 
     x-transition:enter="transition ease-out duration-300"
     x-transition:enter-start="opacity-0"
     x-transition:enter-end="opacity-100"
     x-transition:leave="transition ease-in duration-200"
     x-transition:leave-start="opacity-100"
     x-transition:leave-end="opacity-0"
     class="fixed inset-0 z-[110] lg:hidden bg-black/60 backdrop-blur-sm"
     @click="isMobileMenuOpen = false"
     x-cloak></div>

<div x-show="isMobileMenuOpen" 
     x-transition:enter="transition ease-out duration-300"
     x-transition:enter-start="opacity-0 translate-x-full"
     x-transition:enter-end="opacity-100 translate-x-0"
     x-transition:leave="transition ease-in duration-200"
     x-transition:leave-start="opacity-100 translate-x-0"
     x-transition:leave-end="opacity-0 translate-x-full"
     x-cloak
     class="fixed right-0 top-0 bottom-0 w-[85%] max-w-[400px] z-[120] overflow-y-auto lg:hidden shadow-2xl"
     style="background: linear-gradient(180deg, var(--secondary) 0%, #050d24 100%);">
    
    <div class="flex items-center justify-between p-4 border-b border-white/10">
        <span class="text-xs font-black text-white/40 uppercase tracking-widest">Navigation</span>
        <button @click="isMobileMenuOpen = false" class="p-2 text-white/60 hover:text-white transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        </button>
    </div>

    <nav class="px-4 py-3" x-data="{ openMenus: [] }">
        <template x-for="item in navigationItems" :key="item.label">
            <div>
                <template x-if="item.hasDropdown">
                    <div>
                        <div class="flex items-center justify-between w-full py-3.5 px-4 text-left text-white/90 hover:bg-white/5 border-b border-white/[0.06] transition-all rounded-lg"
                                :class="openMenus.includes(item.label) ? 'bg-[var(--primary)]/10 text-white' : ''">
                            <template x-if="item.href">
                                <a :href="item.href" class="font-semibold text-[15px] flex-1" x-text="item.label" @click.stop="isMobileMenuOpen = false"></a>
                            </template>
                            <template x-if="!item.href">
                                <span class="font-semibold text-[15px] flex-1" x-text="item.label" @click="openMenus.includes(item.label) ? openMenus = openMenus.filter(m => m !== item.label) : openMenus.push(item.label)"></span>
                            </template>
                            
                            <button @click.stop="openMenus.includes(item.label) ? openMenus = openMenus.filter(m => m !== item.label) : openMenus.push(item.label)" class="p-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                     class="text-[var(--primary-light)] transition-transform duration-300"
                                     :class="openMenus.includes(item.label) ? 'rotate-180' : ''"><path d="m6 9 6 6 6-6"/></svg>
                            </button>
                        </div>

                        <!-- Submenu -->
                        <div x-show="openMenus.includes(item.label)" 
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 -translate-y-2"
                             x-transition:enter-end="opacity-100 translate-y-0"
                             class="bg-white/[0.03] mx-2 px-2 py-3 rounded-xl mb-1">
                            <template x-for="(col, colIdx) in item.megaMenu" :key="colIdx">
                                <div class="mb-4 last:mb-0">
                                    <h4 class="text-[var(--primary-light)] text-[11px] font-bold tracking-[0.12em] uppercase pb-2 mb-2 border-b border-white/[0.06] px-3" x-text="col.title"></h4>
                                    <ul class="space-y-0.5">
                                        <template x-for="(subItem, subIdx) in col.items" :key="subIdx">
                                            <li>
                                                <a :href="subItem.href" @click="isMobileMenuOpen = false"
                                                   class="flex items-center py-2.5 px-3 text-sm text-gray-300/80 hover:bg-white/5 hover:text-white rounded-lg transition-all">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 text-white/20"><path d="m9 18 6-6-6-6"/></svg>
                                                    <span x-text="subItem.label"></span>
                                                </a>
                                            </li>
                                        </template>
                                    </ul>
                                </div>
                            </template>
                        </div>
                    </div>
                </template>
                
                <template x-if="!item.hasDropdown">
                    <a :href="item.href || '#'" @click="isMobileMenuOpen = false"
                       class="flex items-center py-3.5 px-4 text-white/90 hover:bg-white/5 border-b border-white/[0.06] transition-all font-semibold text-[15px] rounded-lg">
                       <span x-text="item.label"></span>
                    </a>
                </template>
            </div>
        </template>
    </nav>
</div>
