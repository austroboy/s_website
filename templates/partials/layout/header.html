{% load static %}

<div x-data="{
    isScrolled: false,
    activeMenu: null,
    isMobileMenuOpen: false,
    topBarLinks: [
        { label: 'Publications', href: '/publications' },
        { label: 'International Students', href: '/admission/international' },
        { label: 'Academic Calendar', href: '/academic/calendar' },
        { label: 'Library', href: '/library' },
        { label: 'Newsletters', href: '/newsletters' },
        { label: 'Journals', href: '/research/journals' },
        { label: 'Catalog', href: '/catalog' },
        { label: 'Archive', href: '/archive' },
        { label: 'Contact Us', href: '/contact' }
    ],
    navigationItems: [
        {
            label: 'About',
            hasDropdown: true,
            megaMenu: [
                {
                    title: 'ABOUT NSU',
                    items: [
                        { label: 'Brief History', href: '/about/history' },
                        { label: 'Vision, Mission & Strategy', href: '/about/vision-mission' },
                        { label: 'International Advisory Board', href: '/about/advisory-board' },
                        { label: 'Accreditation', href: '/about/accreditation' },
                        { label: 'International Recognition', href: '/about/recognition' },
                        { label: 'Facts About NSU', href: '/about/facts' }
                    ]
                },
                {
                    title: 'NSU Trustees',
                    items: [
                        { label: 'Board of Trustees', href: '/about/trustees' }
                    ]
                },
                {
                    title: 'Executive Leaders',
                    items: [
                        { label: 'VC, Pro-VC & Treasurer', href: '/about/leadership' },
                        { label: 'Deans, Chairs & Directors', href: '/about/deans' },
                        { label: 'Administration', href: '/about/administration' }
                    ]
                },
                {
                    title: 'Authorities',
                    items: [
                        { label: 'Syndicate', href: '/about/syndicate' },
                        { label: 'Academic Council', href: '/about/academic-council' }
                    ]
                }
            ]
        },
        {
            label: 'Academic',
            hasDropdown: true,
            megaMenu: [
                {
                    title: 'SCHOOLS',
                    items: [
                        { label: 'School of Business & Economics', href: '/academic/sbe' },
                        { label: 'School of Engineering & Physical Sciences', href: '/academic/seps' },
                        { label: 'School of Humanities & Social Sciences', href: '/academic/shss' },
                        { label: 'School of Health & Life Sciences', href: '/academic/shls' }
                    ]
                },
                {
                    title: 'PROGRAMS',
                    items: [
                        { label: 'Undergraduate Programs', href: '/academic/undergraduate' },
                        { label: 'Graduate Programs', href: '/academic/graduate' },
                        { label: 'PhD Programs', href: '/academic/phd' }
                    ]
                }
            ]
        },
        {
            label: 'Faculty',
            hasDropdown: true,
            megaMenu: [
                {
                    title: 'ENGINEERING',
                    items: [
                        { label: 'Computer Science & Engineering', href: '/faculty/cse' },
                        { label: 'Electrical & Computer Engineering', href: '/faculty/ece' }
                    ]
                }
            ]
        },
        { label: 'Alumni', href: '/alumni', hasDropdown: false },
        { label: 'Research', href: '/research', hasDropdown: false }
    ],
    toggleMenu(label) {
        this.activeMenu = this.activeMenu === label ? null : label;
    },
    closeMenu() {
        this.activeMenu = null;
    }
}" 
x-init="window.addEventListener('scroll', () => { isScrolled = window.scrollY > 100 })"
@keydown.escape.window="activeMenu = null; isMobileMenuOpen = false"
class="w-full z-50 transition-all duration-300"
:class="isScrolled ? 'fixed top-0 left-0 animate-slideDown' : 'relative'">

    <!-- Top Bar -->
    <template x-if="!isScrolled">
        {% include 'partials/layout/top_bar.html' %}
    </template>

    <div class="relative" :class="isScrolled ? 'header-scrolled' : 'header-glass'">
        <div class="max-w-[1200px] mx-auto px-6 lg:px-8">
            <div class="flex items-center justify-between h-[60px] lg:h-[70px]">
                
                <!-- Logo -->
                <div class="relative z-10 shrink-0 group">
                    <a href="/" class="block">
                        <img src="https://www.northsouth.edu/newassets/summer_25/img/logo.png" 
                             alt="North South University"
                             class="object-contain w-[45px] h-[45px] lg:w-[130px] lg:h-[60px] transition-all duration-300 group-hover:drop-shadow-[0_0_15px_rgba(0,81,255,0.4)]" />
                    </a>
                </div>

                <!-- Desktop Navigation -->
                <nav class="hidden lg:flex items-center justify-center flex-1 text-white text-[14px] font-[500] tracking-wide">
                    <template x-for="item in navigationItems" :key="item.label">
                        <div class="nav-link-underline flex items-center cursor-pointer px-4 py-2 mx-0.5 rounded-md transition-all duration-200 select-none"
                             :class="activeMenu === item.label ? 'bg-[var(--primary)]/20 text-white' : 'hover:bg-white/5'"
                             @click="item.hasDropdown ? toggleMenu(item.label) : (window.location.href = item.href)"
                             @mouseenter="item.hasDropdown && activeMenu !== null ? (activeMenu = item.label) : null">
                            
                            <span x-text="item.label" class="font-semibold"></span>
                            
                            <template x-if="item.hasDropdown">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                     class="ml-1.5 opacity-70 transition-transform duration-300"
                                     :class="activeMenu === item.label ? 'rotate-180' : ''"><path d="m6 9 6 6 6-6"/></svg>
                            </template>
                        </div>
                    </template>
                </nav>

                <!-- Apply Now CTA -->
                <div class="hidden lg:block">
                    <a href="/admissions/" class="btn-primary-blue text-[13px] px-5 py-2.5 rounded-md">
                        <span class="flex items-center">
                            <i data-lucide="pen-line" class="w-3.5 h-3.5 mr-2"></i>
                            Apply Now
                        </span>
                    </a>
                </div>

                <!-- Mobile Navigation Container -->
                {% include 'partials/layout/mobile_nav.html' %}

            </div>
        </div>

        <!-- Mega Menu -->
        {% include 'partials/layout/mega_menu.html' %}
    </div>
</div>
